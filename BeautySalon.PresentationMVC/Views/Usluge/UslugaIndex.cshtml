@model BeautySalon.PresentationMVC.Models.UslugaSearchViewModel

@{
    ViewData["Title"] = "Popis usluga";
}

<h1 style="margin-bottom:30px;">Šifrarnik usluga</h1>

<div style="display:flex; justify-content:space-between; margin-bottom:30px">
    <div style="display:flex; align-items:center; gap:5px;">
        <a asp-action="Create" class="btn btn-primary">Dodaj novu uslugu</a>
        <button id="editBtn" disabled class="btn btn-warning">Uredi</button>
        <button id="detailsBtn" disabled class="btn btn-info">Detalji</button>
        <button id="deleteBtn" disabled class="btn btn-danger">Obriši</button>
    </div>
    <form method="get" asp-action="Index" class="form-inline" style="display:flex; align-items:center; gap:5px;">
        <input style="height:100%; border:1px solid lightgray; border-radius:5px; padding:0px 10px 0px 10px;" type="text" name="searchTerm" value="@Model.SearchTerm" placeholder="Pretraži usluge..." />
        <button type="submit" class="btn btn-secondary">Pretraži</button>
        <a asp-action="Index" class="btn btn-outline-secondary">Poništi</a>
    </form>
</div>

<table class="table" id="uslugeTable">
    <thead>
        <tr>
            <th>Šifra</th>
            <th>Naziv</th>
            <th>Opis</th>
            <th>Trajanje (min)</th>
            <th>Cijena (€)</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.Usluge)
        {
            <tr data-id="@item.UslugaId" style="cursor:pointer;">
                <td>@item.UslugaId</td>
                <td>@item.Naziv</td>
                <td>@item.Opis</td>
                <td>@item.Trajanje</td>
                <td>@item.Cijena</td>
            </tr>
        }
    </tbody>
</table>

<script>        
    let selectedId = null;

    const rows = document.querySelectorAll('#uslugeTable tbody tr');

    rows.forEach(row => {
        row.addEventListener('click', () => {
            rows.forEach(r => r.style.backgroundColor = '');
            row.style.backgroundColor = '#d3d3d3';
            selectedId = row.getAttribute('data-id');

            document.getElementById('editBtn').disabled = false;
            document.getElementById('detailsBtn').disabled = false;
            document.getElementById('deleteBtn').disabled = false;
        });
    });

    document.getElementById('editBtn').addEventListener('click', () => {
        if (selectedId) {
            window.location.href = `/Usluge/Edit/${selectedId}`;
        }
    });

    document.getElementById('detailsBtn').addEventListener('click', () => {
        if (selectedId) {
            window.location.href = `/Usluge/Details/${selectedId}`;
        }
    });

    document.getElementById('deleteBtn').addEventListener('click', () => {
        if (selectedId) {
            // Umjesto confirm, odmah navigiramo na stranicu za potvrdu brisanja
            window.location.href = `/Usluge/Delete/${selectedId}`;
        }
    });
</script>

